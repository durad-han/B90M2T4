<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="google-signin-scope" content="profile email">
<meta name="google-signin-client_id" content="151296050428-7up6bf2212jt0j9n3qeqm01b6r01q6ed.apps.googleusercontent.com">
<link rel="import" href="../include/baseInclude.html">
<link rel="stylesheet" href="../../css/main/main.css">

<script src="../../js/comm/w3data.js"></script>
<script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
<script src="https://apis.google.com/js/api:client.js"></script>


<script>
  var googleUser = {};
  var startApp = function() {
    gapi.load('auth2', function(){
      // Retrieve the singleton for the GoogleAuth library and set up the client.
      auth2 = gapi.auth2.init({
        client_id: '151296050428-7up6bf2212jt0j9n3qeqm01b6r01q6ed.apps.googleusercontent.com',
        cookiepolicy: 'single_host_origin',
        // Request scopes in addition to 'profile' and 'email'
        //scope: 'additional_scope'
      });
      attachSignin(document.getElementById('customBtn'));
    });
  };

  function attachSignin(element) {
    console.log(element.id);
    auth2.attachClickHandler(element, {},
        function(googleUser) {
          document.getElementById('name').innerText = "Signed in: " +
              googleUser.getBasicProfile().getName() + googleUser.getBasicProfile().getEmail();
        }, function(error) {
          alert(JSON.stringify(error, undefined, 2));
        });
  }
</script>


</head>
<body>
	<div w3-include-html="../include/header.html"></div>
	<div class="wrap">
	<script type="text/javascript" src="https://static.nid.naver.com/js/naverLogin_implicit-1.0.2.js" charset="utf-8"></script>
		
	<div id="content" class="product">
		<div class="proList">
	    	<div class="option">
		    <div class="wrapper">
			    <input type="hidden" name="msg" id="msg" value="${msg}" />
					<form class="form-signin">
						<input type="hidden" name="loginType" value="me" />
						<h2 class="form-signin-heading">AROUND</h2>
						<hr>
						<p class="text-center">로그인</p>
						<hr>
						<p class="text-center">SNS 계정으로 간편하게 로그인하세요!</p>
						<a id="custom-login-btn" href="javascript:loginWithKakao()"> 
							<img src="../../img/main/kakao.png" />
						</a>
						
   						<div id="customBtn" class="customGPlusSignIn">
     							<img style="width:82px; height:83px"src="../../img/main/google.png">
   						</div>
   						
						<p class="text-center">또는</p>
				    	<input type="text" class="form-control" id="id" name="id" placeholder="사용자 계정" required="아이디를 입력하세요." autofocus="" />
				    	<input type="password" class="form-control" id="password" name="password" placeholder="비밀번호" required=""/>      
				    	<button class="btn btn-lg btn-primary btn-block" id="btnLogin">로그인</button>
						<br>
						<br>
						<hr>
						<p class="text-center">
							회원이 아니신가요? <a href="../main/main.html">회원가입</a>
						</p>
						<!-- <button class="btn btn-lg btn-primary btn-block" id="btnLogin">로그인</button> -->
						<br>
			    </form>
		    </div>
			
			</div>
		</div>
		
	</div>
		
	</div>
	
	<div w3-include-html="../include/footer.html"></div>
	
	<script>
		w3IncludeHTML();

		Kakao.init('a2df2dc9167541f9eb937ed24a7e8133');

		function loginWithKakao() {
			// 로그인 창을 띄웁니다.
			Kakao.Auth.login({
				success : function(authObj) {
					
					Kakao.Auth.setAccessToken(authObj.access_token);
					
					Kakao.API.request({
						url : '/v1/user/me',
						success : function(res) {
							alert(JSON.stringify(res))
							
							swal({
						    	title: "이메일 입력!",
						    	text: "사용자 계정을 입력해주세요:",
						    	type: "input",
						    	showCancelButton: true,
						    	closeOnConfirm: false,
						    	animation: "slide-from-top",
						    	inputPlaceholder: "사용자계정"
							},
						  	function(inputValue){
						    	if (inputValue === false) return false;
						  
						    	if (inputValue === "") {
						      		swal.showInputError("You need to write email!");
						      		return false
						    	}
						    	
						    	signUp(inputValue);
						    	
						    	
							});
							
							
						},
						fail : function(error) {
							alert(JSON.stringify(error));
						}
					});
				},
				fail : function(err) {
					alert(JSON.stringify(err));
				}
			});
		};


		function signIn(id) {
			alert(id)
			$.ajax({
				url : "../../login/signIn.do",
				data : {
					userId : id
				},
				dataType : "json"
			}).done(function(msg) {

				if (msg == "LOGIN") {
		    		swal("Info!", id + " 계정으로 이미 가입되었습니다.");
					return false;
				}
		  
		    	swal("Nice!", id + " 계정으로 회원가입 되었습니다.");
				
			});
		}
		
		startApp();
		
	</script>
</body>
</html>