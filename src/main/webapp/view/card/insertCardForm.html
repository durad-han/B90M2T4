<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="import" href="../include/baseInclude.html">
<title>글 등록</title>
<style>
#mapDiv {
	height: 300px;
	width: 500px;
	border: 2px solid blue;
}

img {
	height: 70px;
	width: 70px;
}
#selectFeeling {
	height: 80px;
}
#selectFeeling div {
	float: left;
	margin: 0px 13px;
}
body > div {
	border: 1px solid black;
}
</style>
<script src="../../js/comm/jquery.min.js"></script>
<script src="../../js/comm/googleMapApi.js"></script>
<script src="../../js/card/insertCardForm.js"></script>
</head>
<body>
		<div class="w3-container" id="write">
		<h5 class="w3-center w3-padding-48"><span class="w3-tag w3-wide w3-padding-left w3-padding-right">WRITE</span></h5>
		<div class="w3-content" style="max-width:700px">
			<button onclick="getLocation()">내 위치 조회</button>
			<div id="mapDiv"></div>
			
			<br>
			
			<form id='cardInsert' name='cardInsert' method='post' enctype="multipart/form-data">
			
				<div id="textDiv">
					당신의 이야기를 들려주세요...
					<br>
					<textarea id="cardContent" name="cardContent" rows="7" cols="70"></textarea>
					<div id="count">/140</div>
				</div>
				<br>
				
				<div id="fileDiv">
					파일 등록
					<input class="w3-input w3-padding-16 w3-border" type="file" id="cardImg" name="cardImg"/>
				</div>
				<br>
				
				<div id="hashtagDiv">
					해시태그 등록
					<button type="button" id="hashtagPopup"	onclick="javascript:popupOpen();">#추가</button>
					<input class="w3-input w3-padding-16 w3-border" type="text" id="cardHashtag" name="cardHashtag"/><br>
				</div>
				<br>
				
				<div id="selectFeeling">
					<div>
						<img src="../../img/card/verygood.jpg" /><br>
						<input type="radio" id="verygood" name="cardFeeling" value="1" />
					</div>
					<div>
						<img src="../../img/card/good.png" /><br>
						<input type="radio" id="good" name="cardFeeling" value="2" />
					</div>
					<div>
						<img src="../../img/card/soso.png" /><br>
						<input type="radio" id="soso" name="cardFeeling" value="3" checked />
					</div>
					<div>
						<img src="../../img/card/bad.png" /><br>
						<input type="radio" id="bad" name="cardFeeling" value="4" />
					</div>
					<div>
						<img src="../../img/card/terrible.png" /><br>
						<input type="radio" id="terrible" name="cardFeeling" value="5" />
					</div>
				</div>
				<br>
				
				<input type="hidden" id="cardLongitude" name="cardLongitude" value="3645734" />
				<input type="hidden" id="cardLatitude" name="cardLatitude" value="1275475434" />
<!-- 				<input type="hidden" id="userSeq" name="userSeq" value="13" /> -->
				
				<button class="w3-button w3-black" type="button">취소</button>
				<button class="w3-button w3-black" type="submit">등록</button>
				
			</form>
			</div>
			<script>
			$("#cardInsert").submit(function() {
				
				
				if ($("#cardContent").val() === null) {
					alert("당신의 이야기를 입력해주세요 ^^");
					$("#cardContent").focus();
					return false;
				}
				if ($("#cardFeeling").val() === null) {
					alert("당신의 기분을 선택해주세요 ^^");
					$("#cardFeeling").focus();
					return false;
				}
				if ($("#cardHashtag").val() === null) {
					alert("해시태그를 1개 이상 입력해주세요 ^^");
					$("#cardHashtag").focus();
					return false;
				}
				if ($("#cardLongitude").val() === null) {
					alert("현재 위치를 조회해주세요 ^^");
					$("#cardLongitude").focus();
					return false;
				}

				var fd = new FormData();
				var files = $("input[name=cardImg]")[0].files;
				
				fd.append("cardContent", $("[name=cardContent]").val());
				fd.append("cardFeeling", $("input[name=cardFeeling]").val());
				fd.append("cardHashtag", $("input[name=cardHashtag]").val());
				fd.append("cardLongitude", $("input[name=cardLongitude]").val());
				fd.append("cardLatitude", $("input[name=cardLatitude]").val());
				fd.append("cardLatitude", $("input[name=userSeq]").val());
					
				for (var i = 0 ; i < files.length ; i++) {
					fd.append("cardImgPath", files[i]);
				}
				
				$.ajax({
					url: "/b90m2t4/card/insert.do",
					type: "post",
					data: fd,
// 					dataType: "json",
					processData: false,
					contentType: false
				})
				.done (function (result) {
					
				})
				.fail (function (jqXhr, textStatus, errorText) {
					alert("에러발생 : " + errorText);
				});	
				return false;
			});
			</script>
			
		</div>
	
	<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBWJxPZFiG_3QbcXlfIG71_VGDDUuZS5Oc&callback=initMap"></script>
</body>
</html>
