<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<link rel="import" href="../include/baseInclude.html">
<link rel="stylesheet" href="../../css/main/main.css">
<script src="../../js/comm/jquery.min.js"></script>
<script src="../../js/comm/paging.js"></script>
<script src="../../js/card/retrieveCardDetail.js"></script>
<script src="../../js/comm/w3data.js"></script>
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
<title>detail</title>
<style>
#cardArea{ 
	border: 1px solid silver; 
	width: 850px; height: 350px;
	text-align: center;
	}
#commentArea{ 
	border: 1px solid silver; 
	width: 850px; height: 200px; 
	}
.card{ 
	margin : 20px; padding: 20px;
 	background-color: white;  
	width: 600px; height: 250px;
	text-align: center;
	}
.comment{ 
	border: 1px solid navy;
 	background-color: white;
	float: left;
	margin: 5px; padding: 5px;
	width: 250px; height: 180px;
	text-align: center;
	}
.side{
	float: left;
/* 	width: 100px; height: 1000px; */
}
.body{
	float: left;
}
</style>
</head>
<body>
	
<div w3-include-html="../include/header.html"></div>
	
<div class="proList">
	<div class="option">
		<div class="wrapper">
			<h2 class="form-signin-heading"> A R O U N D </h2>
			<h4 class="form-signin-heading"> (임시)카드 상세조회 페이지 </h4>

			<div id="leftSide" class="side">
				<button id="prev">◁</button>
			</div>
			
			<div class="body">
				
				<div id="cardArea">
				
					<div id="cardHere">
					</div>
					
				</div>
				
				<div id="commentArea"></div>
				<div id="pagingArea"></div>
		
			</div>
			
			<div id="rightSide" class="side">
				<button id="next">▷</button>
			</div>
	
		</div>
	</div>
</div>

<!-- <div w3-include-html="../include/footer.html"></div> -->

<script>
	w3IncludeHTML();

	function summonCard(){
		$.ajax({
			url: "/b90m2t4/card/retrieve.json",
			type: "POST",
			data: {cardSeq: 1},
			dataType: "json"
		})
		.done(makeCard);
		
		$.ajax({
			url: "/b90m2t4/card/retrieveCommentList.json",
			type: "POST",
			data: {	cardSeq: 1,
					pageNo: 1
					},
			dataType: "json"
		})
		.done(makeComment);
	}
	
	function makeCard(card){
		var html = "";
			html += '<div class="card">';
			html += card.cardContent + '<br><br>';
			html += card.cardHashtag + '<br><br>';
			html += card.cardFeeling + '<br><br>';
			html += card.cardRegDate + '<br><br>';
		
		if (card == null){
			html += '카드가 존재하지 않습니다 <br><br>';
		}
		$("#cardHere").html(html);
	}
	
	function makeComment(commentMap){
		var html = "";
		var comments = commentMap['commentList'];
		var page = commentMap['pageResult'];
		// 디버그용 console.dir
		console.dir(comments);
		console.dir(page);
		
		for (var i = 0 ; i < comments.length ; i++ ){
				html += '<div class="comment">';
				var comment = comments[i];
				html += comment.commentContent + '<br><br>';
				html += comment.commentRegDate + '<br><br>';
				html += '</div>';
		}
		
		if (comments == null){
			html += '<div class="comment">';
			html += '아무도 이 카드에 반응하지 않았습니다 <br><br>';
			html += '<button>첫 댓글 남기기<button>';
			html += '</div>';
			
		}
			$("#commentArea").html(html);
			$("#pagingArea").paging({
					max: page.endPage,
					current: page.pageNo,
					length: page.tabSize,
					});
	}
	
	function goPage(pageNo) {
		$.ajax({
			url: "/b90m2t4/card/retrieveCommentList.json",
			type: "POST",
			data: {	cardSeq: 1,
					pageNo: page.pageNo
					},
			dataType: "json"
		})
		.done(makeComment);
	}
	
	summonCard();
</script>
</body>
</html>